# Node.js
# Build a general Node.js project with npm.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript

trigger:
- master
- dev
- test
- prod

pool:
  vmImage: ubuntu-latest
   
variables:
  sourceBranch: $[variables['Build.SourceBranch']]
  targetPullRequestBranch: $[variables['System.PullRequest.TargetBranch']]

stages:
- stage: Dev1
  displayName: Dev Stage 1
  condition: and(eq(variables['Build.Reason'], 'IndividualCI'), eq(variables['Build.SourceBranch'], 'refs/heads/dev'))
  # condition: and(eq(variables['Build.Reason'], 'PullRequest'), eq(variables['System.PullRequest.TargetBranch'], 'dev'))
  jobs:
  - job: PrintSourceBranch
    steps:
      - script: echo SourceBranch - $(sourceBranch)
        displayName: Source Branch Val

- stage: Dev2
  displayName: Dev Stage 2
  jobs:
  - job: PrintTargetPullRequestBranch
    steps:
      - script: echo TargetBranch - $(targetPullRequestBranch)
        displayName: Target Branch Val

      - script: echo End of Dev
        displayName: Final  