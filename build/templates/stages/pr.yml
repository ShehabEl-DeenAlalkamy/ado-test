parameters:
  - name: vars
    type: object

stages:
  - stage: PullRequestDetails
    displayName: PR Details
    jobs:
      - job: Logger
        displayName: Logs
        steps:
          - script: |
              echo 'variables.Build.Reason                      : ${{ variables['Build.Reason'] }}'
              echo 'variables.Build.SourceBranch                : ${{ variables['Build.SourceBranch'] }}'
              echo 'variables.System.PullRequest.SourceBranch   : ${{ parameters.vars.System.PullRequest.SourceBranch }}'
              echo 'variables.System.PullRequest.TargetBranch   : ${{ parameters.vars.System.PullRequest.TargetBranch }}'
              echo 'variables.effectiveBranchName               : ${{ parameters.vars.effectiveBranchName }}'
              echo 'variables.shortHandPRTargetBranch           : ${{ parameters.vars.shortHandPRTargetBranch }}'
      
      - job: SetDetails
        displayName: Set Details
        steps:
          - bash: |
              export DETAILS="PR: $SYSTEM_PULLREQUEST_SOURCEBRANCH --> $SYSTEM_PULLREQUEST_TARGETBRANCH"
              export TARGETBRANCH="${{ parameters.vars.shortHandPRTargetBranch }}"

              echo "##vso[task.setvariable variable=DISPLAY_NAME;isOutput=true]$DETAILS"
              echo "##vso[task.setvariable variable=PR_TARGET_BRANCH;isOutput=true]$TARGETBRANCH"
            name: set_details
